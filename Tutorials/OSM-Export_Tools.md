# [overpass turbo](http://overpass-turbo.eu)   

Overpass turbo is fantastic way to query and export just the data you want from OSM.  

## Exporting Parking Lots and Parking Spaces in Virginia-Highland Neighborhood
The following is an example I used when I wanted to export parking lots and parking spaces in my neighborhood.

The first query was constructed by using the Wizard tool, where I entered the parking lot tag, which is amenity=parking

```
<!--
This has been generated by the overpass-turbo wizard.
The original search was:
“amenity=parking”
-->
<osm-script output="json" timeout="25">
  <!-- gather results -->
  <union>
    <!-- query part for: “amenity=parking” -->
    <query type="node">
      <has-kv k="amenity" v="parking"/>
      <bbox-query {{bbox}}/>
    </query>
    <query type="way">
      <has-kv k="amenity" v="parking"/>
      <bbox-query {{bbox}}/>
    </query>
    <query type="relation">
      <has-kv k="amenity" v="parking"/>
      <bbox-query {{bbox}}/>
    </query>
  </union>
  <!-- print results -->
  <print mode="body"/>
  <recurse type="down"/>
  <print mode="skeleton" order="quadtile"/>
</osm-script>
```
While this worked great, I was interested in getting two different features returned from my query, specifically I wanted to return both parking lots and individual parking spaces.  Parking spaces are rendered currently on the default OSM Mapnik rederer, but their are [accepted tagging practices](http://wiki.openstreetmap.org/wiki/Tag:amenity%3Dparking_space) for capturing this information in OSM.  

According to the Overpass API [language guide](http://wiki.openstreetmap.org/wiki/Overpass_API/Language_Guide), the Overpass API query language supports relative (e.g. non-exact) expressions of locations and names.  Since I'd like the query to return records for both parking lots (amenity=parking) and parking spaces (amenity=parking_space), and the value tag for each starts with the word 'parking,' I wanted to see if I could use a wildcard character which would return both values.  According to the Language Guide for Non-exact names, to create a query which returns all substring values which start with the work 'parking', you change the value variable name ('v') to 'regv', and add an '^' to the query string.  

```
<!--
This script changes variable name 'v' to 'regv'
and adds a '^' to the beginning of the query string 
-->
<osm-script output="json" timeout="25">
  <!-- gather results -->
  <union>
    <!-- query part for: “amenity=parking” 
    and “amenity=parking_space” 
    -->
    <query type="node">
      <has-kv k="amenity" regv="^parking"/>
      <bbox-query {{bbox}}/>
    </query>
    <query type="way">
      <has-kv k="amenity" regv="^parking"/>
      <bbox-query {{bbox}}/>
    </query>
    <query type="relation">
      <has-kv k="amenity" regv="^parking"/>
      <bbox-query {{bbox}}/>
    </query>
  </union>
  <!-- print results -->
  <print mode="body"/>
  <recurse type="down"/>
  <print mode="skeleton" order="quadtile"/>
</osm-script>
```
When first experimenting with Overpass Turbo, I used the map window extent to define the AOI for my query.  However, to get the entire area of my AOI, I was having to include a lot of extra areas of the map that I was not interested in.  To narrow the extent of my query, I decided to add a custom AOI to the bbox-query argument.

A helpful tool when you need to quickly get the Lat/Long values for a bounding box is [bbox finder](http://bboxfinder.com/).  Simply pan and zoom to your area of interest on the interactive map, then draw a polygon around your AOI, and automatically the bounding coordinates will be shown at the bottom of the screen.  Be careful to note that the order of the coordinates implies which number defines each side of the bounding box!  bbox finder outputs coordinates as: West, South, East, North.  According to the Overpass Turbo API Guide though, Overpass Turbo expects the coordinates in the order of : East, North, West, South.  I replaced the bounding box argument above (`<bbox-query {{bbox}}/>`) with the following: `<bbox-query e="-84.335818" n="33.794841" s="33.771085" w="  -84.370322"/>`

The following script queries all buildings using the custom bounding box (which generates a large 7MB file).

```
<osm-script output="json" timeout="25">
  <!-- gather results -->
  <union>
    <!-- query part for: “building= ' '” -->
    <query type="node">
      <has-kv k="building" modv="" v=""/>
      <bbox-query e="-84.335818" n="33.794841" s="33.771085" w="  -84.370322"/>
    </query>
    <query type="way">
      <has-kv k="building" modv="" v=""/>
      <bbox-query e="-84.335818" n="33.794841" s="33.771085" w="  -84.370322"/>
    </query>
    <query type="relation">
      <has-kv k="building" modv="" v=""/>
      <bbox-query e="-84.335818" n="33.794841" s="33.771085" w="  -84.370322"/>
    </query>
  </union>
  <!-- print results -->
  <print mode="body"/>
  <recurse type="down"/>
  <print mode="skeleton" order="quadtile"/>
</osm-script>
```
## Query all features with a tag of key="Highway", aka. query all the streets
The following query is intended to return all the streets within the Overpass Turbo map window.  The query searches for features of type="way" that have key="highway", regardles of whether the tag value is primary, trunk, residential, service, etc.
```
<osm-script output="json" timeout="25">
  <!-- gather results -->
    <query type="way">
      <has-kv k="highway"/>
      <bbox-query {{bbox}}/>
    </query>
  <!-- print results -->
  <print mode="body"/>
  <recurse type="down"/>
  <print mode="skeleton" order="quadtile"/>
</osm-script>
```
